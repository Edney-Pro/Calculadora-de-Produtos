<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Produtos Novos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="calculator-container">
        <!-- Header -->
        <div class="calculator-header">
            <div class="header-content">
                <h1><i class="bi bi-calculator me-2"></i>Calculadora de Produtos Novos</h1>
                <p>Parcele seus produtos NOVOS em at√© 36x SEM ENTRADA</p>
            </div>
        </div>

        <div class="content-wrapper">
            <!-- Barra de Progresso -->
            <div class="progress-container">
                <div class="progress"><div class="progress-bar" role="progressbar" style="width: 16.6%;" id="progressBar"></div></div>
            </div>

            <div class="content-area">
                <!-- TELA 1: DADOS PESSOAIS E DIA DO PAGAMENTO -->
                <div class="etapa active" id="tela1">
                    <h4 class="section-title"><i class="bi bi-person-badge me-2"></i>Dados Pessoais</h4>
                    <div class="mb-3"><label class="form-label">Nome completo:</label><input type="text" class="form-control" id="clientName" placeholder="Ex: Jo√£o Silva Santos" required oninput="checkTela1Ready()"></div>
                    <div class="mb-3"><label class="form-label">CPF:</label><input type="text" class="form-control" id="clientCPF" placeholder="Ex: 000.000.000-00" required oninput="checkTela1Ready()"></div>
                    
                    <div class="dia-pagamento-container mt-4">
                        <h6 class="mb-3"><i class="bi bi-calendar-heart me-2"></i>Escolha o dia da 1¬™ parcela (limite de 33 dias)</h6>
                        <div class="row g-3" id="opcoesDiaPagamentoContainer">
                            <!-- Bot√µes de data ser√£o gerados aqui pelo JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- TELA 2 a TELA 5 (Conte√∫do Mantido) -->
                <div class="etapa" id="tela2">
                    <h4 class="section-title"><i class="bi bi-person-check me-2"></i>Status do Cliente</h4>
                    <div class="d-grid gap-2 mb-3">
                        <button type="button" class="btn btn-selection" onclick="selectClientStatus('yes', this)"><i class="bi bi-person-check"></i> J√° sou cliente</button>
                        <button type="button" class="btn btn-selection" onclick="selectClientStatus('no', this)"><i class="bi bi-person-x"></i> N√£o sou cliente</button>
                        <button type="button" class="btn btn-selection" onclick="selectClientStatus('create', this)"><i class="bi bi-person-plus"></i> Criar Cadastro</button>
                    </div>
                </div>
                <div class="etapa" id="tela3">
                    <h4 class="section-title"><i class="bi bi-person-lines-fill me-2"></i>Situa√ß√£o do Cliente</h4>
                    <div id="clientStatusOptions" class="hidden"><h6 class="mb-3">Selecione sua situa√ß√£o atual:</h6><div class="d-grid gap-2"><button type="button" class="btn btn-selection" onclick="selectClientSituation('no', this)"><i class="bi bi-check-circle"></i> Parcelas em Dia</button><button type="button" class="btn btn-selection" onclick="selectClientSituation('yes', this)"><i class="bi bi-exclamation-triangle"></i> Parcela Pendente</button></div></div>
                    <div id="nonClientForm" class="hidden"><h6 class="mb-3">Como ficou sabendo do nosso servi√ßo?</h6><div class="d-grid gap-2 mb-3"><button type="button" class="btn btn-selection" onclick="selectSource('instagram', this)"><i class="bi bi-instagram"></i> Instagram</button><button type="button" class="btn btn-selection" onclick="selectSource('facebook', this)"><i class="bi bi-facebook"></i> Facebook</button><button type="button" class="btn btn-selection" onclick="selectSource('whatsapp', this)"><i class="bi bi-whatsapp"></i> Whatsapp</button><button type="button" class="btn btn-selection" onclick="selectSource('indicado', this)"><i class="bi bi-person-check"></i> Indicado</button></div><div class="mt-3 hidden" id="indicadoField"><input type="text" class="form-control" id="clientIndicado" placeholder="Quem te indicou?" required></div></div>
                </div>
                <div class="etapa" id="tela4">
                    <h4 class="section-title section-produtos"><i class="bi bi-cart-plus me-2"></i>Cadastro de Produtos</h4>
                    <div class="produto-form">
                        <div class="row g-2 align-items-end">
                            <div class="col-8"><label class="form-label">Nome do Produto:</label><input type="text" class="form-control" id="produtoNome" required></div>
                            <div class="col-4"><label class="form-label">Pre√ßo R$:</label><input type="number" class="form-control" id="produtoValor" min="0" step="0.01" required></div>
                        </div>
                        <button type="button" class="btn btn-success w-100 mt-3" onclick="adicionarProduto()"><i class="bi bi-plus-circle"></i> Adicionar Produto</button>
                    </div>
                    <div class="produtos-lista-container mt-4">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6>Produtos Adicionados:</h6>
                            <div id="totalProdutos" class="fw-bold"></div>
                        </div>
                        <div class="produtos-lista" id="listaProdutos">
                             <!-- Lista de produtos ser√° inserida aqui -->
                        </div>
                    </div>
                </div>
                <div class="etapa" id="tela5">
                    <h4 class="section-title"><i class="bi bi-calendar-range me-2"></i>Selecione a Parcela</h4>
                    <div class="visor-principal valor-parcela mb-3">
                        <small>Valor Total do Financiamento</small>
                        <div class="valor-display" id="valorTotalFinanciamento">R$ 0,00</div>
                    </div>

                    <div class="parcelas-grid-container">
                        <h6 class="mb-3 text-center"><i class="bi bi-check-circle me-2"></i>Escolha o n√∫mero de parcelas ideais:</h6>
                        <div id="gruposParcelas">
                             <!-- Grupos de parcelas ser√£o gerados aqui pelo JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- TELA 6: Resumo Completo -->
                <div class="etapa" id="tela6">
                    <div class="summary-section">
                        <div class="summary-header">
                            <h5 class="text-center mb-1"><i class="bi bi-file-text me-2"></i>Resumo da Simula√ß√£o</h5>
                            <small class="text-muted d-block text-center" id="dataOrcamento"></small>
                        </div>
                        <div class="summary-block" id="dadosPessoaisBlock"></div>
                        <div class="summary-block" id="produtosBlock"></div>
                        <div class="summary-block" id="pagamentoBlock"></div>
                        <div class="summary-block" id="cronogramaBlock"></div>
                       
                      <div class="summary-block mt-3" id="obsBlock">
                            <h6 class="summary-block-title"><i class="bi bi-info-circle me-2"></i>Observa√ß√µes Importantes</h6>
                            <p class="obs-text">
                                Em caso de atraso, o valor da sua parcela ser√° atualizado com os seguintes acr√©scimos:
                            </p>
                            <ul class="obs-list">
                                <li><strong>Multa por atraso:</strong> Valor √∫nico de <strong>18%</strong>.</li>
                                <li><strong>Juros di√°rios:</strong> Valor de <strong>1%</strong> por dia de atraso.</li>
                            </ul>
                        </div>
                        
                        <!-- BOT√ÉO WHATSAPP FINAL (LARGURA TOTAL) -->
                        <button class="btn btn-whatsapp-final w-100 mt-3" onclick="enviarWhatsApp()">
                            <i class="bi bi-whatsapp"></i> Compartilhar Resumo Whatsapp ou Enviar Proposta
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rodap√© Fixo do App: 3 Bot√µes de A√ß√£o Espec√≠ficos para a Etapa (DIN√ÇMICO) -->
        <div class="footer-actions" id="footerActions">
            <!-- O conte√∫do ser√° preenchido pelo JavaScript para Tela 1-5 ou Tela 6 -->
        </div>
        
        <!-- Rodap√© Global: 6 Bot√µes de Acesso Global (FIXO) -->
        <nav class="quick-nav-bar" id="quickNavBar">
            <div class="container">
                <!-- 1. Home Geral -->
                <a href="../../../index.html" class="quick-nav-item" title="Home Geral">
                    <span class="quick-nav-icon">üè†</span>
                </a>
                
                <!-- 2. Tela Anterior (Home Categoria PRODUTOS) -->
                <a href="../produtos.html" class="quick-nav-item" title="Tela Anterior (Produtos)">
                    <span class="quick-nav-icon">üì¶</span>
                </a>
                
                <!-- 3. Configura√ß√µes de Taxas (Com PIN - PROTEGIDO) -->
                <a href="#" id="navConfigTaxas" class="quick-nav-item" title="Configura√ß√µes">
                    <span class="quick-nav-icon">‚öôÔ∏è</span>
                </a>
                
                <!-- 4. WhatsApp (Acesso P√∫blico) -->
                <a href="https://wa.me/449984084" target="_blank" class="quick-nav-item" title="WhatsApp">
                    <span class="quick-nav-icon" style="color:#25D366">üìû</span>
                </a>
                
                <!-- 5. Instagram (Acesso P√∫blico) -->
                <a href="https://www.instagram.com/encomendapalotina" target="_blank" class="quick-nav-item" title="Instagram">
                    <span class="quick-nav-icon">üì∏</span>
                </a>

                <!-- 6. Ajuda (ACESSA MODAL DE AJUDA, SEM PIN) -->
                <a href="#" id="navAjuda" class="quick-nav-item" title="Ajuda" onclick="abrirModalAjuda(event)">
                    <span class="quick-nav-icon">‚ùì</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- Modal de Configura√ß√µes (Apenas PIN e Taxa) -->
    <div class="modal-overlay hidden" id="configModal">
        <div class="modal-content">
            <div id="pinView">
                <h4>Acesso Restrito</h4>
                <p>Digite o PIN para acessar as configura√ß√µes.</p>
                <input type="password" id="pinInput" class="form-control" placeholder="PIN" onkeydown="if(event.key === 'Enter') verificarPIN()">
                <button class="btn btn-primary w-100 mt-3" onclick="verificarPIN()">Acessar</button>
                <button class="btn btn-secondary w-100 mt-2" onclick="fecharModalConfig()">Fechar</button>
            </div>
            <div id="settingsView" class="hidden">
                <h4>Configura√ß√µes</h4><hr>
                <div class="mb-3">
                    <label class="form-label">Tema do Aplicativo</label>
                    <div class="d-flex gap-2">
                        <button class="btn btn-selection w-100" id="btnThemeDark" onclick="definirTema('dark')"><i class="bi bi-moon-stars-fill"></i> Escuro</button>
                        <button class="btn btn-selection w-100" id="btnThemeLight" onclick="definirTema('light')"><i class="bi bi-sun-fill"></i> Claro</button>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="taxaInput" class="form-label">Taxa de Juros Mensal (%)</label>
                    <input type="number" id="taxaInput" class="form-control" step="0.1"><small class="text-muted">Ex: digite 9 para 9% a.m.</small>
                </div>
                
                <!-- Campos de Configura√ß√£o de Atraso -->
                <h5 class="mt-4">Configura√ß√µes de Atraso</h5>
                <div class="mb-3">
                    <label for="multaInput" class="form-label">Multa por Atraso (%)</label>
                    <input type="number" id="multaInput" class="form-control" step="0.1">
                    <small class="text-muted">Ex: digite 18 para 18% (valor √∫nico).</small>
                </div>
                <div class="mb-3">
                    <label for="jurosAtrasoInput" class="form-label">Juros Di√°rios por Atraso (%)</label>
                    <input type="number" id="jurosAtrasoInput" class="form-control" step="0.01">
                    <small class="text-muted">Ex: digite 1 para 1% ao dia.</small>
                </div>
                <!-- FIM NOVOS CAMPOS -->

                <button class="btn btn-success w-100 mt-3" onclick="salvarConfig()">Salvar e Fechar</button>
                <button class="btn btn-secondary w-100 mt-2" onclick="fecharModalConfig()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Todas as Op√ß√µes de Parcelamento -->
    <div class="modal-overlay hidden" id="parcelasModal">
        <div class="modal-content modal-fullscreen">
            <div class="modal-header">
                <h4><i class="bi bi-calendar-range me-2"></i> Todas as Op√ß√µes de Parcelamento</h4>
            </div>
            <div class="modal-body">
                <p class="text-center text-muted">Selecione a melhor op√ß√£o para avan√ßar.</p>
                <div id="parcelasModalGrid">
                    <!-- Grupos de parcelas ser√£o inseridos aqui pelo JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger w-100" onclick="fecharModalParcelas()">
                    <i class="bi bi-x-circle me-2"></i> Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Ajuda (Resumo de Etapas - ACESSO LIVRE) -->
    <div class="modal-overlay hidden" id="ajudaModal">
        <div class="modal-content modal-fullscreen">
            <div class="modal-header">
                <h4><span class="quick-nav-icon">‚ùì</span> Ajuda: Resumo do App</h4>
            </div>
            <div class="modal-body" id="ajudaBody"></div>
            <div class="modal-footer">
                <button class="btn btn-danger w-100" onclick="fecharModalAjuda()">
                    <i class="bi bi-x-circle me-2"></i> Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Simula√ß√£o de Atraso em Tela Cheia -->
    <div class="modal-overlay hidden" id="atrasoModal">
        <div class="modal-content modal-fullscreen">
            <div class="modal-header">
                <h4><i class="bi bi-calculator me-2"></i> Simulador de Atraso</h4>
            </div>
            <div class="modal-body">
                <p class="text-center mb-4">Veja o valor atualizado de uma parcela em atraso</p>
                
                <div class="mb-4">
                    <label for="diasAtrasoInput" class="form-label fw-bold">Dias em Atraso:</label>
                    <input type="number" id="diasAtrasoInput" class="form-control" value="30" min="1" max="365" oninput="calcularSimulacaoAtraso()">
                </div>
                
                <div class="atraso-details">
                    <div>
                        <span>Valor Original da Parcela:</span> 
                        <span id="atrasoValorOriginal">R$ 0,00</span>
                    </div>
                    <div>
                        <span>Multa (<span id="multaPercentDisplay">18%</span>):</span> 
                        <span id="atrasoValorMulta">R$ 0,00</span>
                    </div>
                    <div>
                        <span>Juros Di√°rios (<span id="jurosDiariosPercentDisplay">1%</span>):</span> 
                        <span id="atrasoValorJuros">R$ 0,00</span>
                    </div>
                    
                    <hr>
                    
                    <div class="fw-bold">
                        <span>TOTAL A PAGAR:</span> 
                        <span id="atrasoValorTotalComObservacao">R$ 0,00</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger w-100" onclick="fecharModalAtraso()">
                    <i class="bi bi-x-circle me-2"></i> Fechar Simulador
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>